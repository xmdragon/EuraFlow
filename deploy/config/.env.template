#===============================================================================
# EuraFlow 环境配置模板
#
# 说明：
# 1. 复制此文件为 .env 并根据实际情况修改
# 2. 所有 {{变量}} 需要替换为实际值
# 3. 敏感信息请妥善保管
#===============================================================================

#-------------------------------------------------------------------------------
# 基础配置
#-------------------------------------------------------------------------------
# 运行环境: development | staging | production
EF__ENV=production

# 调试模式（生产环境必须设为false）
EF__DEBUG=false

# 应用密钥（用于加密会话等）
EF__SECRET_KEY={{SECRET_KEY}}

# 时区设置
EF__TIMEZONE=Asia/Shanghai

#-------------------------------------------------------------------------------
# 数据库配置
#-------------------------------------------------------------------------------
# PostgreSQL连接URL
EF__DATABASE__URL=postgresql://{{DB_USER}}:{{DB_PASSWORD}}@{{DB_HOST}}:{{DB_PORT}}/{{DB_NAME}}

# 连接池配置
EF__DATABASE__POOL_SIZE=20
EF__DATABASE__MAX_OVERFLOW=40
EF__DATABASE__POOL_TIMEOUT=30
EF__DATABASE__POOL_RECYCLE=1800

# 数据库备份（可选）
EF__DATABASE__BACKUP_ENABLED=true
EF__DATABASE__BACKUP_SCHEDULE="0 2 * * *"
EF__DATABASE__BACKUP_RETENTION_DAYS=7

#-------------------------------------------------------------------------------
# Redis配置
#-------------------------------------------------------------------------------
# Redis连接URL
EF__REDIS__URL=redis://{{REDIS_HOST}}:{{REDIS_PORT}}/0

# Redis密码（如果有）
EF__REDIS__PASSWORD={{REDIS_PASSWORD}}

# 缓存配置
EF__CACHE__TTL=3600
EF__CACHE__PREFIX=ef_cache_
EF__CACHE__VERSION=1

# 会话存储
EF__SESSION__STORE=redis
EF__SESSION__TTL=86400

#-------------------------------------------------------------------------------
# API服务配置
#-------------------------------------------------------------------------------
# 服务监听地址
EF__API__HOST=0.0.0.0
EF__API__PORT=8000

# Worker配置
EF__API__WORKERS=4
EF__API__WORKER_CLASS=uvicorn.workers.UvicornWorker
EF__API__WORKER_CONNECTIONS=1000
EF__API__KEEPALIVE=5

# API基础URL（用于生成完整URL）
EF__API__BASE_URL=https://{{DOMAIN_NAME}}

# API版本
EF__API__VERSION=v1

# 请求限制
EF__API__MAX_REQUEST_SIZE=52428800  # 50MB
EF__API__REQUEST_TIMEOUT=60

#-------------------------------------------------------------------------------
# 日志配置
#-------------------------------------------------------------------------------
# 日志级别: DEBUG | INFO | WARNING | ERROR | CRITICAL
EF__LOG__LEVEL=INFO

# 日志文件
EF__LOG__FILE=/var/log/euraflow/app.log
EF__LOG__MAX_SIZE=10485760  # 10MB
EF__LOG__BACKUP_COUNT=10

# 日志格式
EF__LOG__FORMAT="%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# 访问日志
EF__LOG__ACCESS_FILE=/var/log/euraflow/access.log
EF__LOG__ERROR_FILE=/var/log/euraflow/error.log

#-------------------------------------------------------------------------------
# CORS配置
#-------------------------------------------------------------------------------
# 允许的源
EF__CORS__ORIGINS=["https://{{DOMAIN_NAME}}"]

# 允许凭证
EF__CORS__CREDENTIALS=true

# 允许的方法
EF__CORS__METHODS=["GET", "POST", "PUT", "DELETE", "OPTIONS"]

# 允许的头
EF__CORS__HEADERS=["Content-Type", "Authorization", "X-Requested-With"]

# 预检请求缓存时间
EF__CORS__MAX_AGE=3600

#-------------------------------------------------------------------------------
# 认证和会话配置
#-------------------------------------------------------------------------------
# JWT配置
EF__AUTH__JWT_SECRET={{JWT_SECRET}}
EF__AUTH__JWT_ALGORITHM=HS256
EF__AUTH__ACCESS_TOKEN_EXPIRE=1800  # 30分钟
EF__AUTH__REFRESH_TOKEN_EXPIRE=604800  # 7天

# 会话配置
EF__SESSION__SECRET={{SESSION_SECRET}}
EF__SESSION__EXPIRE=86400  # 24小时
EF__SESSION__HTTPONLY=true
EF__SESSION__SECURE=true  # HTTPS环境必须为true
EF__SESSION__SAMESITE=lax

#-------------------------------------------------------------------------------
# 文件上传配置
#-------------------------------------------------------------------------------
# 上传目录
EF__UPLOAD__DIR=/opt/euraflow/uploads
EF__UPLOAD__MAX_SIZE=52428800  # 50MB

# 允许的文件类型
EF__UPLOAD__ALLOWED_EXTENSIONS=["jpg", "jpeg", "png", "gif", "pdf", "xlsx", "xls", "csv"]

# 图片处理
EF__IMAGE__MAX_WIDTH=2048
EF__IMAGE__MAX_HEIGHT=2048
EF__IMAGE__QUALITY=85
EF__IMAGE__WATERMARK_ENABLED=true

#-------------------------------------------------------------------------------
# 邮件配置（可选）
#-------------------------------------------------------------------------------
EF__MAIL__ENABLED=false
EF__MAIL__SMTP_HOST={{SMTP_HOST}}
EF__MAIL__SMTP_PORT={{SMTP_PORT}}
EF__MAIL__SMTP_USER={{SMTP_USER}}
EF__MAIL__SMTP_PASSWORD={{SMTP_PASSWORD}}
EF__MAIL__USE_TLS=true
EF__MAIL__FROM_ADDRESS={{FROM_EMAIL}}
EF__MAIL__FROM_NAME=EuraFlow

#-------------------------------------------------------------------------------
# OZON渠道配置
#-------------------------------------------------------------------------------
# OZON API凭证
EF__OZON__CLIENT_ID={{OZON_CLIENT_ID}}
EF__OZON__API_KEY={{OZON_API_KEY}}

# OZON API设置
EF__OZON__SANDBOX=false
EF__OZON__BASE_URL=https://api-seller.ozon.ru
EF__OZON__TIMEOUT=30
EF__OZON__MAX_RETRIES=3
EF__OZON__RETRY_DELAY=1

# OZON同步设置
EF__OZON__SYNC_INTERVAL=300  # 5分钟
EF__OZON__SYNC_BATCH_SIZE=100
EF__OZON__SYNC_ENABLED=true

# OZON仓库配置
EF__OZON__WAREHOUSE_ID={{OZON_WAREHOUSE_ID}}
EF__OZON__FBO_ENABLED=true
EF__OZON__FBS_ENABLED=true

# OZON价格策略
EF__OZON__PRICING_STRATEGY=auto
EF__OZON__MIN_MARGIN=0.15
EF__OZON__MAX_DISCOUNT=0.30

#-------------------------------------------------------------------------------
# 任务队列配置
#-------------------------------------------------------------------------------
# Celery配置
EF__CELERY__BROKER_URL=redis://{{REDIS_HOST}}:{{REDIS_PORT}}/1
EF__CELERY__RESULT_BACKEND=redis://{{REDIS_HOST}}:{{REDIS_PORT}}/2
EF__CELERY__TASK_SERIALIZER=json
EF__CELERY__RESULT_SERIALIZER=json
EF__CELERY__ACCEPT_CONTENT=["json"]
EF__CELERY__TIMEZONE=Asia/Shanghai
EF__CELERY__ENABLE_UTC=true

# 任务配置
EF__TASK__DEFAULT_QUEUE=default
EF__TASK__PRIORITY_QUEUE=priority
EF__TASK__SLOW_QUEUE=slow
EF__TASK__MAX_RETRIES=3
EF__TASK__RETRY_DELAY=60

#-------------------------------------------------------------------------------
# 监控和告警配置
#-------------------------------------------------------------------------------
# 健康检查
EF__HEALTH__ENABLED=true
EF__HEALTH__ENDPOINT=/health
EF__HEALTH__CHECK_DB=true
EF__HEALTH__CHECK_REDIS=true
EF__HEALTH__CHECK_DISK=true

# Prometheus指标
EF__METRICS__ENABLED=true
EF__METRICS__ENDPOINT=/metrics
EF__METRICS__PREFIX=euraflow_

# 告警配置
EF__ALERT__ENABLED=false
EF__ALERT__WEBHOOK_URL={{ALERT_WEBHOOK_URL}}
EF__ALERT__ERROR_THRESHOLD=10
EF__ALERT__RESPONSE_TIME_THRESHOLD=1000

#-------------------------------------------------------------------------------
# 安全配置
#-------------------------------------------------------------------------------
# 速率限制
EF__RATE_LIMIT__ENABLED=true
EF__RATE_LIMIT__DEFAULT="100/hour"
EF__RATE_LIMIT__API="1000/hour"
EF__RATE_LIMIT__AUTH="10/minute"

# IP白名单（可选）
EF__SECURITY__IP_WHITELIST=[]

# IP黑名单（可选）
EF__SECURITY__IP_BLACKLIST=[]

# CSRF保护
EF__SECURITY__CSRF_ENABLED=true
EF__SECURITY__CSRF_TOKEN_LENGTH=32

# 密码策略
EF__SECURITY__PASSWORD_MIN_LENGTH=8
EF__SECURITY__PASSWORD_REQUIRE_UPPERCASE=true
EF__SECURITY__PASSWORD_REQUIRE_LOWERCASE=true
EF__SECURITY__PASSWORD_REQUIRE_NUMBERS=true
EF__SECURITY__PASSWORD_REQUIRE_SPECIAL=true

#-------------------------------------------------------------------------------
# 第三方服务配置（可选）
#-------------------------------------------------------------------------------
# 阿里云OSS（对象存储）
EF__OSS__ENABLED=false
EF__OSS__ACCESS_KEY_ID={{OSS_ACCESS_KEY_ID}}
EF__OSS__ACCESS_KEY_SECRET={{OSS_ACCESS_KEY_SECRET}}
EF__OSS__BUCKET={{OSS_BUCKET}}
EF__OSS__ENDPOINT={{OSS_ENDPOINT}}

# 短信服务
EF__SMS__ENABLED=false
EF__SMS__PROVIDER=aliyun
EF__SMS__ACCESS_KEY={{SMS_ACCESS_KEY}}
EF__SMS__ACCESS_SECRET={{SMS_ACCESS_SECRET}}
EF__SMS__SIGN_NAME={{SMS_SIGN_NAME}}

# 微信配置
EF__WECHAT__ENABLED=false
EF__WECHAT__APP_ID={{WECHAT_APP_ID}}
EF__WECHAT__APP_SECRET={{WECHAT_APP_SECRET}}
EF__WECHAT__TOKEN={{WECHAT_TOKEN}}

#-------------------------------------------------------------------------------
# 开发和调试配置
#-------------------------------------------------------------------------------
# 开发模式特定配置
EF__DEV__AUTO_RELOAD=false
EF__DEV__PROFILING=false
EF__DEV__SQL_ECHO=false
EF__DEV__MOCK_EXTERNAL_API=false

# 测试配置
EF__TEST__DATABASE_URL=postgresql://test:test@localhost:5432/euraflow_test
EF__TEST__REDIS_URL=redis://localhost:6379/15

#-------------------------------------------------------------------------------
# 备份和恢复配置
#-------------------------------------------------------------------------------
# 自动备份
EF__BACKUP__AUTO_ENABLED=true
EF__BACKUP__SCHEDULE="0 3 * * *"
EF__BACKUP__RETENTION_DAYS=30
EF__BACKUP__S3_BUCKET={{BACKUP_S3_BUCKET}}
EF__BACKUP__LOCAL_PATH=/backup/euraflow

#-------------------------------------------------------------------------------
# 自定义配置
#-------------------------------------------------------------------------------
# 在此添加项目特定的配置项